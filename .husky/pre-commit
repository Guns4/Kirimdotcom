echo "üõ°Ô∏è  GUARD: Checking code before commit..."

# 1. Run Lint-Staged
echo "   [1/2] Running Lint-Staged..."
npx lint-staged
if [ $? -ne 0 ]; then
    echo "   ‚ùå Linting Failed! Auto-fix couldn't resolve everything."
    echo "      Please fix the errors above."
    exit 1
fi

# 2. Run TypeScript Check
echo "   [2/2] Checking Types (tsc)..."
npx tsc --noEmit
if [ $? -ne 0 ]; then
    echo "   ‚ùå Type Check Failed!"
    echo "      FIX ERROR FIRST!"
    exit 1
fi

echo "   ‚úÖ Code is clean. Committing..."